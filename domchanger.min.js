("object"==typeof module&&"object"==typeof module.exports&&function(e){module.exports=e()}||"function"==typeof define&&function(e){define("domchanger",e)}||function(e){window.domChanger=e()})(function(){"use strict"
function e(n,o,i){function a(){k.parentNode.appendChild(k),Object.keys(E).forEach(function(e){var t=E[e]
t.el?o.appendChild(t.el):t.append&&t.append()})}function c(){k.parentNode.removeChild(k),k=null,f(E),delete O.update,delete O.destroy,delete O.handleEvent,C()}function f(e){Object.keys(e).forEach(function(t){var n=e[t]
n.el?n.el.parentNode.removeChild(n.el):n.destroy&&n.destroy(),delete e[t],n.children&&f(n.children)})}function p(){if(j){var e=t(j.apply(null,b))
s(o,e,E)}}function d(e){e.destroy?e.destroy():e.el.parentNode.removeChild(e.el)}function s(t,n,o){Object.keys(o).forEach(function(e){if(!n[e]){var t=o[e]
d(t),delete o[e]}})
var i=Object.keys(o),a=Object.keys(n)
a.forEach(function(a,l){var c=o[a],f=n[a],p=i.indexOf(a)
if(void 0!==f.text)c?f.text!==c.text&&(c.el.nodeValue=c.text=f.text):(c=o[a]={text:f.text,el:document.createTextNode(f.text)},t.appendChild(c.el))
else if(f.tagName)c||(c=o[a]={tagName:f.tagName,el:document.createElement(f.tagName),children:{}},f.ref&&(c.ref=f.ref,y[c.ref]=c.el),t.appendChild(c.el)),c.props||(c.props={}),r(c.el,f.props,c.props),f.children&&s(c.el,f.children,c.children)
else if(f.component)c||(c=o[a]=e(f.component,t,O),c.append()),c.update.apply(null,f.data)
else{if(!f.el)throw console.error(f),Error("This shouldn't happen")
c&&(c=d(c)),c=o[a]={el:f.el},t.appendChild(c.el)}if(p>=0&&l>p){var u=o[a]
u.append?u.append():t.appendChild(u.el)}})}function m(){b=u.call(arguments),p()}function v(){if(!i)throw Error("Can't emit events from top-level component")
i.handleEvent.apply(null,arguments)}function h(e){var t=x[e]
if(!t){if(i)return i.handleEvent.apply(null,arguments)
throw Error("Missing event handler for "+e)}t.apply(null,u.call(arguments,1))}var y={},b=[],E={},g=n(v,p,y),j=g.render,x=g.on||{},C=g.cleanup||l,O={update:m,destroy:c,append:a,handleEvent:h},k=document.createComment(n.name)
return o.appendChild(k),O}function t(e){function t(e,r){var o,i,l
if("number"==typeof r&&(r+=""),"string"==typeof r)o="text"
else if(Array.isArray(r)){if(!r.length)return
if(i=r[0],"function"==typeof i)o="component"
else{if("string"!=typeof i)return void r.forEach(function(n){t(e,n)})
l=n(r),o="element"}}else{if(!(r instanceof HTMLElement))throw console.error(r),new TypeError("Invalid item")
o="el"}for(var c,f=0,p="element"===o?l.ref||l.name:"component"===o?r.key||r[0].name:o;e[c=p+"-"+f++];);var d
if("text"===o)return void(e[c]={text:r})
if("el"===o)return void(e[c]={el:r})
if("element"===o){var u={}
return d=e[c]={tagName:l.name},a(l.props)||(d.props=l.props),l.ref&&(d.ref=l.ref),l.body.forEach(function(e){t(u,e)}),void(a(u)||(d.children=u))}if("component"===o)return void(e[c]={component:r[0],data:r.slice(1)})
throw new TypeError("Invalid type")}var r={}
return t(r,e),r}function n(e){var t,n={}
if(e[1]&&e[1].constructor===Object){for(var r=Object.keys(e[1]),o=0,a=r.length;a>o;o++){var l=r[o]
n[l]=e[1][l]}t=e.slice(2)}else t=e.slice(1)
var u=e[0],s=u.match(d),m={name:s?s[0]:"div",props:n,body:t},v=u.match(c)
v&&(v=v.map(i).join(" "),n["class"]?n["class"]+=" "+v:n["class"]=v)
var h=u.match(f)
h&&(n.id=i(h[0]))
var y=u.match(p)
return y&&(m.ref=i(y[0])),m}function r(e,t,n){Object.keys(n).forEach(function(r){if(!t||!t[r]){if("on"===r.substr(0,2)){var o=r.substring(2)
e.removeEventListener(o,n[r])}else e.removeAttribute(r)
n[r]=null}}),t&&Object.keys(t).forEach(function(r){var i=t[r],a=n[r]
if("style"===r&&"object"==typeof i)"string"==typeof a&&e.removeAttribute("style"),a&&"object"==typeof a||(a=n.style={}),o(e.style,i,a)
else{if(a===i)return
if("on"===r.substr(0,2)){var l=r.substring(2)
a&&e.removeEventListener(l,a),e.addEventListener(l,i),n[r]=i}else"boolean"==typeof i?i?e.setAttribute(r,r):e.removeAttribute(r):"value"===r&&"INPUT"===e.nodeName?e.value=i:e.setAttribute(r,i),n[r]=i}})}function o(e,t,n){Object.keys(n).forEach(function(r){t&&t[r]||(n[r]=e[r]="")}),t&&Object.keys(t).forEach(function(r){var o=t[r],i=n[r]
i!==o&&(n[r]=e[r]=t[r])})}function i(e){return e.substring(1)}function a(e){return!Object.keys(e).length}function l(){}var c=/\.[^.#$]+/g,f=/#[^.#$]+/,p=/\$[^.#$]+/,d=/^[^.#$]+/,u=[].slice
return e})
